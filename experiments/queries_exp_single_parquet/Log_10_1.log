Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
17/04/24 11:57:57 WARN spark.SparkConf: The configuration key 'spark.akka.frameSize' has been deprecated as of Spark 1.6 and may be removed in the future. Please use the new key 'spark.rpc.message.maxSize' instead.
17/04/24 11:58:11 WARN spark.SparkConf: The configuration key 'spark.akka.frameSize' has been deprecated as of Spark 1.6 and may be removed in the future. Please use the new key 'spark.rpc.message.maxSize' instead.
17/04/24 11:58:11 WARN spark.SparkConf: The configuration key 'spark.akka.frameSize' has been deprecated as of Spark 1.6 and may be removed in the future. Please use the new key 'spark.rpc.message.maxSize' instead.
17/04/24 11:58:12 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
17/04/24 11:58:14 WARN spark.SparkConf: The configuration key 'spark.akka.frameSize' has been deprecated as of Spark 1.6 and may be removed in the future. Please use the new key 'spark.rpc.message.maxSize' instead.
17/04/24 11:58:24 WARN metastore.ObjectStore: Failed to get database global_temp, returning NoSuchObjectException
Spark context Web UI available at http://128.110.152.45:4040
Spark context available as 'sc' (master = spark://ctl:7077, app id = app-20170424115814-0093).
Spark session available as 'spark'.
Welcome to
      ____              __
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 2.1.0
      /_/
         
Using Scala version 2.11.8 (OpenJDK 64-Bit Server VM, Java 1.8.0_121)
Type in expressions to have them evaluated.
Type :help for more information.

scala> //spark-shell --master spark://ctl:7077 --driver-memory 28G  --executor-memory 28G  --executor-cores  8  --num-executors 16  --conf spark.io.compression.codec=lzf  --conf spark.akka.frameSize=1024  --conf spark .driver.maxResultSize=2g

scala> 

scala> 

scala> import java.io.File
import java.io.File

scala> import java.io.FileOutputStream
import java.io.FileOutputStream

scala> 

scala> val queryMsg = "#QUERY "
queryMsg: String = "#QUERY "

scala> val loadDBMsg = "#LOAD_DB "
loadDBMsg: String = "#LOAD_DB "

scala> val loadTable = "#LOAD_TABLE "
loadTable: String = "#LOAD_TABLE "

scala> val loadSqlContext = "#LOAD_SQL_CONTEXT "
loadSqlContext: String = "#LOAD_SQL_CONTEXT "

scala> val dataSource = "/nidan/parquet/Slides-uncompressed-256-ZINDEX.prqt"
dataSource: String = /nidan/parquet/Slides-uncompressed-256-ZINDEX.prqt

scala> 

scala> def show_timing[T](proc: => T): T = {
     |     val start=System.nanoTime()
     |     val res = proc
     |     val end = System.nanoTime()
     |     println("Time elapsed: " + (end-start)/1000000000.0 + " seconds")
     |     res
     | }
show_timing: [T](proc: => T)T

scala> 

scala> val writeToLocal = (in:(Array[Byte], Long, String)) =>{
     |     val bytes = in._1
     |     val output = in._3
     |     
     |     val writer = new FileOutputStream(output)
     |     writer.write(bytes)
     |     writer.close
     |   }
writeToLocal: ((Array[Byte], Long, String)) => Unit = <function1>

scala> 

scala> val queries = List(
     | ("SELECT imageBytes from data where partitionZIndex >= 1 and partitionZIndex <=1 and imageLevel = 0 a nd imageId = '1.svs'",1),
     | ("SELECT imageBytes from data where partitionZIndex >= 1 and partitionZIndex <=2 and imageLevel = 0 a nd imageId = '1.svs'",2),
     | ("SELECT imageBytes from data where partitionZIndex >= 1 and partitionZIndex <=4 and imageLevel = 0 a nd imageId = '1.svs'",4),
     | ("SELECT imageBytes from data where partitionZIndex >= 1 and partitionZIndex <=8 and imageLevel = 0 a nd imageId = '1.svs'",8)
     | )
queries: List[(String, Int)] = List((SELECT imageBytes from data where partitionZIndex >= 1 and partitionZIndex <=1 and imageLevel = 0 and imageId = '1.svs',1), (SELECT imageBytes from data where partitionZIndex >= 1 and partitionZIndex <=2 and imageLevel = 0 and imageId = '1.svs',2), (SELECT imageBytes from data where partitionZIndex >= 1 and partitionZIndex <=4 and imageLevel = 0 and imageId = '1.svs',4), (SELECT imageBytes from data where partitionZIndex >= 1 and partitionZIndex <=8 and imageLevel = 0 and imageId = '1.svs',8))

scala> 

scala> 

scala> val sqlContext = show_timing{new org.apache.spark.sql.SQLContext(sc)}
warning: there was one deprecation warning; re-run with -deprecation for details
Time elapsed: 0.001209025 seconds
sqlContext: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@6426ad0b

scala> val pf = show_timing{sqlContext.read.parquet(dataSource)}
Time elapsed: 7.858422174 seconds
pf: org.apache.spark.sql.DataFrame = [imageId: string, imageLevel: int ... 8 more fields]

scala> show_timing{pf.createOrReplaceTempView("data")}
Time elapsed: 0.785605932 seconds

scala> 

scala> 

scala> show_timing{sqlContext.sql(queries(0)._1).map(_.getAs[Array[Byte]](0)).rdd.zipWithIndex.map{case (byt es, index) => (bytes, index, s"o6_${index}.JPEG")}.collect.map(writeToLocal).filter(_ => false).size}
[Stage 1:>                                                     (0 + 112) / 1152][Stage 1:>                                                     (6 + 112) / 1152][Stage 1:>                                                     (7 + 112) / 1152][Stage 1:>                                                     (8 + 112) / 1152][Stage 1:>                                                    (10 + 112) / 1152][Stage 1:>                                                    (13 + 112) / 1152][Stage 1:>                                                    (14 + 112) / 1152][Stage 1:>                                                    (17 + 112) / 1152][Stage 1:>                                                    (18 + 112) / 1152][Stage 1:=>                                                   (24 + 112) / 1152][Stage 1:==>                                                  (50 + 112) / 1152][Stage 1:====>                                                (97 + 112) / 1152][Stage 1:====>                                               (106 + 112) / 1152][Stage 1:======>                                             (133 + 112) / 1152][Stage 1:======>                                             (145 + 112) / 1152][Stage 1:=======>                                            (158 + 112) / 1152][Stage 1:=======>                                            (170 + 112) / 1152][Stage 1:========>                                           (181 + 112) / 1152][Stage 1:=========>                                          (209 + 112) / 1152][Stage 1:=========>                                          (220 + 112) / 1152][Stage 1:==========>                                         (237 + 112) / 1152][Stage 1:===========>                                        (256 + 112) / 1152][Stage 1:============>                                       (270 + 112) / 1152][Stage 1:=============>                                      (302 + 112) / 1152][Stage 1:==============>                                     (331 + 112) / 1152][Stage 1:===============>                                    (345 + 112) / 1152][Stage 1:================>                                   (359 + 112) / 1152][Stage 1:================>                                   (376 + 112) / 1152][Stage 1:=================>                                  (396 + 112) / 1152][Stage 1:==================>                                 (415 + 112) / 1152][Stage 1:===================>                                (433 + 112) / 1152][Stage 1:====================>                               (444 + 112) / 1152][Stage 1:====================>                               (459 + 112) / 1152][Stage 1:=====================>                              (473 + 112) / 1152][Stage 1:======================>                             (492 + 112) / 1152][Stage 1:=======================>                            (523 + 112) / 1152][Stage 1:========================>                           (538 + 112) / 1152][Stage 1:=========================>                          (558 + 112) / 1152][Stage 1:==========================>                         (578 + 112) / 1152][Stage 1:==========================>                         (597 + 112) / 1152][Stage 1:===========================>                        (609 + 112) / 1152][Stage 1:============================>                       (627 + 112) / 1152][Stage 1:=============================>                      (644 + 112) / 1152][Stage 1:==============================>                     (666 + 112) / 1152][Stage 1:==============================>                     (685 + 112) / 1152][Stage 1:===============================>                    (707 + 112) / 1152][Stage 1:================================>                   (731 + 112) / 1152][Stage 1:==================================>                 (764 + 112) / 1152][Stage 1:===================================>                (779 + 112) / 1152][Stage 1:====================================>               (806 + 112) / 1152][Stage 1:=====================================>              (831 + 112) / 1152][Stage 1:======================================>             (852 + 112) / 1152][Stage 1:=======================================>            (883 + 112) / 1152][Stage 1:=========================================>          (917 + 112) / 1152][Stage 1:==========================================>         (947 + 112) / 1152][Stage 1:============================================>       (985 + 112) / 1152][Stage 1:=============================================>     (1023 + 112) / 1152][Stage 1:==============================================>    (1043 + 109) / 1152][Stage 1:===============================================>    (1061 + 91) / 1152][Stage 1:=================================================>  (1087 + 65) / 1152][Stage 1:=================================================>  (1107 + 45) / 1152][Stage 1:==================================================> (1114 + 38) / 1152][Stage 1:==================================================> (1118 + 34) / 1152][Stage 1:===================================================>(1133 + 19) / 1152][Stage 1:===================================================>(1137 + 15) / 1152][Stage 1:===================================================>(1139 + 13) / 1152][Stage 1:====================================================>(1143 + 9) / 1152][Stage 1:====================================================>(1145 + 7) / 1152][Stage 1:====================================================>(1146 + 6) / 1152][Stage 1:====================================================>(1148 + 4) / 1152][Stage 1:====================================================>(1149 + 3) / 1152][Stage 1:====================================================>(1150 + 2) / 1152][Stage 1:====================================================>(1151 + 1) / 1152]                                                                                [Stage 2:>                                                    (19 + 112) / 1153][Stage 2:=>                                                   (41 + 112) / 1153][Stage 2:==>                                                  (65 + 112) / 1153][Stage 2:====>                                                (88 + 112) / 1153][Stage 2:====>                                               (110 + 112) / 1153][Stage 2:=====>                                              (131 + 112) / 1153][Stage 2:======>                                             (150 + 112) / 1153][Stage 2:=======>                                            (174 + 112) / 1153][Stage 2:========>                                           (192 + 112) / 1153][Stage 2:=========>                                          (217 + 112) / 1153][Stage 2:==========>                                         (239 + 112) / 1153][Stage 2:===========>                                        (262 + 112) / 1153][Stage 2:============>                                       (287 + 112) / 1153][Stage 2:==============>                                     (320 + 112) / 1153][Stage 2:===============>                                    (350 + 112) / 1153][Stage 2:================>                                   (368 + 112) / 1153][Stage 2:=================>                                  (391 + 112) / 1153][Stage 2:==================>                                 (415 + 112) / 1153][Stage 2:===================>                                (438 + 112) / 1153][Stage 2:====================>                               (456 + 112) / 1153][Stage 2:=====================>                              (471 + 112) / 1153][Stage 2:======================>                             (492 + 112) / 1153][Stage 2:=======================>                            (524 + 112) / 1153][Stage 2:=========================>                          (556 + 112) / 1153][Stage 2:==========================>                         (583 + 112) / 1153][Stage 2:===========================>                        (606 + 112) / 1153][Stage 2:===========================>                        (619 + 112) / 1153][Stage 2:=============================>                      (644 + 112) / 1153][Stage 2:=============================>                      (657 + 112) / 1153][Stage 2:===============================>                    (694 + 112) / 1153][Stage 2:================================>                   (717 + 113) / 1153][Stage 2:=================================>                  (743 + 112) / 1153][Stage 2:==================================>                 (771 + 112) / 1153][Stage 2:====================================>               (805 + 112) / 1153][Stage 2:=====================================>              (833 + 112) / 1153][Stage 2:=======================================>            (871 + 112) / 1153][Stage 2:========================================>           (909 + 112) / 1153][Stage 2:==========================================>         (943 + 112) / 1153][Stage 2:============================================>       (978 + 112) / 1153][Stage 2:============================================>      (1016 + 112) / 1153][Stage 2:==============================================>    (1040 + 112) / 1153][Stage 2:===============================================>    (1062 + 91) / 1153][Stage 2:================================================>   (1086 + 67) / 1153][Stage 2:==================================================> (1112 + 41) / 1153][Stage 2:==================================================> (1119 + 34) / 1153][Stage 2:==================================================> (1128 + 25) / 1153][Stage 2:===================================================>(1133 + 20) / 1153][Stage 2:===================================================>(1138 + 15) / 1153][Stage 2:===================================================>(1141 + 12) / 1153][Stage 2:===================================================>(1142 + 11) / 1153][Stage 2:====================================================>(1146 + 7) / 1153][Stage 2:====================================================>(1147 + 6) / 1153][Stage 2:====================================================>(1148 + 5) / 1153][Stage 2:====================================================>(1149 + 4) / 1153][Stage 2:====================================================>(1150 + 3) / 1153][Stage 2:====================================================>(1151 + 2) / 1153][Stage 2:====================================================>(1152 + 1) / 1153]                                                                                Time elapsed: 34.163839524 seconds
res1: Int = 0

scala> 

scala> for (query <- queries){
     | println(s">> Running query: ${query._1}")
     | show_timing{sqlContext.sql(query._1).map(_.getAs[Array[Byte]](0)).rdd.zipWithIndex.map{case (bytes, i ndex) => (bytes, index, s"o6_${index}.JPEG")}.collect.map(writeToLocal).filter(_ => false).size}
     | }
>> Running query: SELECT imageBytes from data where partitionZIndex >= 1 and partitionZIndex <=1 and imageLevel = 0 and imageId = '1.svs'
[Stage 3:>                                                       (0 + 0) / 1152][Stage 3:=>                                                   (23 + 112) / 1152][Stage 3:==>                                                  (47 + 112) / 1152][Stage 3:===>                                                 (72 + 112) / 1152][Stage 3:====>                                                (94 + 112) / 1152][Stage 3:=====>                                              (117 + 112) / 1152][Stage 3:======>                                             (140 + 112) / 1152][Stage 3:=======>                                            (161 + 112) / 1152][Stage 3:========>                                           (179 + 112) / 1152][Stage 3:=========>                                          (207 + 112) / 1152][Stage 3:==========>                                         (232 + 112) / 1152][Stage 3:===========>                                        (257 + 112) / 1152][Stage 3:============>                                       (281 + 112) / 1152][Stage 3:==============>                                     (318 + 112) / 1152][Stage 3:===============>                                    (341 + 112) / 1152][Stage 3:================>                                   (365 + 112) / 1152][Stage 3:=================>                                  (387 + 112) / 1152][Stage 3:==================>                                 (419 + 113) / 1152][Stage 3:===================>                                (438 + 112) / 1152][Stage 3:====================>                               (458 + 112) / 1152][Stage 3:=====================>                              (474 + 112) / 1152][Stage 3:======================>                             (499 + 112) / 1152][Stage 3:========================>                           (532 + 112) / 1152][Stage 3:=========================>                          (564 + 112) / 1152][Stage 3:==========================>                         (590 + 112) / 1152][Stage 3:===========================>                        (609 + 112) / 1152][Stage 3:============================>                       (628 + 112) / 1152][Stage 3:=============================>                      (647 + 112) / 1152][Stage 3:==============================>                     (668 + 112) / 1152][Stage 3:===============================>                    (688 + 112) / 1152][Stage 3:================================>                   (716 + 112) / 1152][Stage 3:=================================>                  (750 + 112) / 1152][Stage 3:===================================>                (778 + 112) / 1152][Stage 3:====================================>               (812 + 112) / 1152][Stage 3:======================================>             (842 + 112) / 1152][Stage 3:=======================================>            (873 + 112) / 1152][Stage 3:=========================================>          (913 + 112) / 1152][Stage 3:===========================================>        (958 + 112) / 1152][Stage 3:=============================================>      (997 + 112) / 1152][Stage 3:=============================================>     (1037 + 112) / 1152][Stage 3:==============================================>    (1048 + 104) / 1152][Stage 3:================================================>   (1074 + 78) / 1152][Stage 3:=================================================>  (1098 + 54) / 1152][Stage 3:==================================================> (1114 + 38) / 1152][Stage 3:==================================================> (1119 + 33) / 1152][Stage 3:===================================================>(1130 + 22) / 1152][Stage 3:===================================================>(1140 + 12) / 1152][Stage 3:===================================================>(1141 + 11) / 1152][Stage 3:====================================================>(1146 + 6) / 1152][Stage 3:====================================================>(1147 + 5) / 1152][Stage 3:====================================================>(1148 + 4) / 1152][Stage 3:====================================================>(1150 + 2) / 1152][Stage 3:====================================================>(1151 + 1) / 1152]                                                                                [Stage 4:=>                                                   (41 + 112) / 1153][Stage 4:==>                                                  (64 + 112) / 1153][Stage 4:===>                                                 (81 + 112) / 1153][Stage 4:====>                                               (109 + 112) / 1153][Stage 4:=====>                                              (127 + 112) / 1153][Stage 4:======>                                             (145 + 112) / 1153][Stage 4:=======>                                            (167 + 112) / 1153][Stage 4:========>                                           (193 + 112) / 1153][Stage 4:=========>                                          (212 + 112) / 1153][Stage 4:==========>                                         (243 + 112) / 1153][Stage 4:============>                                       (268 + 112) / 1153][Stage 4:=============>                                      (297 + 112) / 1153][Stage 4:==============>                                     (326 + 112) / 1153][Stage 4:================>                                   (355 + 112) / 1153][Stage 4:=================>                                  (381 + 112) / 1153][Stage 4:==================>                                 (403 + 112) / 1153][Stage 4:===================>                                (425 + 112) / 1153][Stage 4:====================>                               (445 + 112) / 1153][Stage 4:=====================>                              (468 + 112) / 1153][Stage 4:======================>                             (492 + 113) / 1153][Stage 4:=======================>                            (519 + 112) / 1153][Stage 4:========================>                           (549 + 112) / 1153][Stage 4:==========================>                         (583 + 112) / 1153][Stage 4:===========================>                        (603 + 112) / 1153][Stage 4:============================>                       (625 + 112) / 1153][Stage 4:============================>                       (640 + 112) / 1153][Stage 4:=============================>                      (665 + 113) / 1153][Stage 4:===============================>                    (688 + 112) / 1153][Stage 4:================================>                   (715 + 112) / 1153][Stage 4:=================================>                  (739 + 112) / 1153][Stage 4:==================================>                 (761 + 112) / 1153][Stage 4:====================================>               (799 + 112) / 1153][Stage 4:=====================================>              (831 + 112) / 1153][Stage 4:======================================>             (857 + 112) / 1153][Stage 4:========================================>           (899 + 112) / 1153][Stage 4:==========================================>         (942 + 112) / 1153][Stage 4:============================================>       (984 + 112) / 1153][Stage 4:=============================================>     (1023 + 112) / 1153][Stage 4:==============================================>    (1044 + 109) / 1153][Stage 4:================================================>   (1065 + 88) / 1153][Stage 4:=================================================>  (1098 + 55) / 1153][Stage 4:==================================================> (1113 + 40) / 1153][Stage 4:==================================================> (1121 + 32) / 1153][Stage 4:===================================================>(1132 + 21) / 1153][Stage 4:===================================================>(1137 + 16) / 1153][Stage 4:===================================================>(1140 + 13) / 1153][Stage 4:====================================================>(1144 + 9) / 1153][Stage 4:====================================================>(1148 + 5) / 1153][Stage 4:====================================================>(1149 + 4) / 1153][Stage 4:====================================================>(1150 + 3) / 1153][Stage 4:====================================================>(1151 + 2) / 1153][Stage 4:====================================================>(1152 + 1) / 1153]                                                                                Time elapsed: 24.61727959 seconds
>> Running query: SELECT imageBytes from data where partitionZIndex >= 1 and partitionZIndex <=2 and imageLevel = 0 and imageId = '1.svs'
[Stage 5:>                                                    (13 + 112) / 1152][Stage 5:=>                                                   (33 + 112) / 1152][Stage 5:==>                                                  (56 + 112) / 1152][Stage 5:===>                                                 (77 + 112) / 1152][Stage 5:====>                                                (96 + 112) / 1152][Stage 5:=====>                                              (120 + 112) / 1152][Stage 5:======>                                             (148 + 112) / 1152][Stage 5:========>                                           (179 + 112) / 1152][Stage 5:========>                                           (197 + 112) / 1152][Stage 5:==========>                                         (228 + 112) / 1152][Stage 5:===========>                                        (250 + 112) / 1152][Stage 5:============>                                       (282 + 112) / 1152][Stage 5:==============>                                     (318 + 112) / 1152][Stage 5:===============>                                    (335 + 112) / 1152][Stage 5:================>                                   (363 + 112) / 1152][Stage 5:=================>                                  (388 + 112) / 1152][Stage 5:==================>                                 (413 + 112) / 1152][Stage 5:===================>                                (436 + 112) / 1152][Stage 5:====================>                               (457 + 112) / 1152][Stage 5:=====================>                              (481 + 112) / 1152][Stage 5:======================>                             (508 + 112) / 1152][Stage 5:========================>                           (533 + 112) / 1152][Stage 5:=========================>                          (561 + 112) / 1152][Stage 5:==========================>                         (589 + 112) / 1152][Stage 5:===========================>                        (613 + 112) / 1152][Stage 5:============================>                       (626 + 112) / 1152][Stage 5:=============================>                      (647 + 112) / 1152][Stage 5:==============================>                     (668 + 112) / 1152][Stage 5:===============================>                    (698 + 112) / 1152][Stage 5:================================>                   (727 + 112) / 1152][Stage 5:==================================>                 (757 + 112) / 1152][Stage 5:===================================>                (793 + 112) / 1152][Stage 5:=====================================>              (820 + 112) / 1152][Stage 5:======================================>             (860 + 112) / 1152][Stage 5:========================================>           (893 + 112) / 1152][Stage 5:==========================================>         (942 + 112) / 1152][Stage 5:============================================>       (980 + 112) / 1152][Stage 5:=============================================>     (1018 + 112) / 1152][Stage 5:==============================================>    (1045 + 107) / 1152][Stage 5:================================================>   (1067 + 85) / 1152][Stage 5:=================================================>  (1093 + 59) / 1152][Stage 5:=================================================>  (1104 + 48) / 1152][Stage 5:==================================================> (1119 + 33) / 1152][Stage 5:==================================================> (1127 + 25) / 1152][Stage 5:===================================================>(1135 + 17) / 1152][Stage 5:===================================================>(1139 + 13) / 1152][Stage 5:===================================================>(1142 + 10) / 1152][Stage 5:====================================================>(1145 + 7) / 1152][Stage 5:====================================================>(1147 + 5) / 1152][Stage 5:====================================================>(1148 + 4) / 1152][Stage 5:====================================================>(1149 + 3) / 1152][Stage 5:====================================================>(1150 + 2) / 1152][Stage 5:====================================================>(1151 + 1) / 1152]                                                                                [Stage 6:=>                                                   (34 + 112) / 1153][Stage 6:==>                                                  (56 + 112) / 1153][Stage 6:===>                                                 (80 + 112) / 1153][Stage 6:====>                                                (96 + 112) / 1153][Stage 6:=====>                                              (122 + 112) / 1153][Stage 6:======>                                             (141 + 112) / 1153][Stage 6:=======>                                            (163 + 112) / 1153][Stage 6:========>                                           (188 + 112) / 1153][Stage 6:=========>                                          (214 + 112) / 1153][Stage 6:==========>                                         (240 + 112) / 1153][Stage 6:===========>                                        (263 + 112) / 1153][Stage 6:=============>                                      (293 + 112) / 1153][Stage 6:==============>                                     (318 + 112) / 1153][Stage 6:===============>                                    (346 + 112) / 1153][Stage 6:================>                                   (375 + 112) / 1153][Stage 6:=================>                                  (399 + 112) / 1153][Stage 6:===================>                                (424 + 112) / 1153][Stage 6:====================>                               (448 + 112) / 1153][Stage 6:=====================>                              (467 + 112) / 1153][Stage 6:=====================>                              (483 + 112) / 1153][Stage 6:=======================>                            (515 + 112) / 1153][Stage 6:========================>                           (547 + 112) / 1153][Stage 6:=========================>                          (567 + 112) / 1153][Stage 6:==========================>                         (595 + 112) / 1153][Stage 6:===========================>                        (619 + 112) / 1153][Stage 6:============================>                       (643 + 112) / 1153][Stage 6:=============================>                      (662 + 112) / 1153][Stage 6:===============================>                    (689 + 113) / 1153][Stage 6:================================>                   (722 + 112) / 1153][Stage 6:=================================>                  (752 + 112) / 1153][Stage 6:===================================>                (778 + 112) / 1153][Stage 6:====================================>               (804 + 112) / 1153][Stage 6:======================================>             (843 + 112) / 1153][Stage 6:=======================================>            (877 + 112) / 1153][Stage 6:=========================================>          (919 + 112) / 1153][Stage 6:===========================================>        (960 + 112) / 1153][Stage 6:============================================>      (1000 + 112) / 1153][Stage 6:=============================================>     (1026 + 112) / 1153][Stage 6:==============================================>    (1048 + 105) / 1153][Stage 6:================================================>   (1082 + 71) / 1153][Stage 6:=================================================>  (1106 + 47) / 1153][Stage 6:==================================================> (1112 + 41) / 1153][Stage 6:==================================================> (1121 + 32) / 1153][Stage 6:===================================================>(1132 + 21) / 1153][Stage 6:===================================================>(1137 + 16) / 1153][Stage 6:===================================================>(1140 + 13) / 1153][Stage 6:====================================================>(1144 + 9) / 1153][Stage 6:====================================================>(1146 + 7) / 1153][Stage 6:====================================================>(1147 + 6) / 1153][Stage 6:====================================================>(1148 + 5) / 1153][Stage 6:====================================================>(1149 + 4) / 1153][Stage 6:====================================================>(1151 + 2) / 1153][Stage 6:====================================================>(1152 + 1) / 1153]                                                                                Time elapsed: 24.793128988 seconds
>> Running query: SELECT imageBytes from data where partitionZIndex >= 1 and partitionZIndex <=4 and imageLevel = 0 and imageId = '1.svs'
[Stage 7:=>                                                   (25 + 112) / 1152][Stage 7:=>                                                   (42 + 112) / 1152][Stage 7:==>                                                  (65 + 112) / 1152][Stage 7:====>                                                (89 + 112) / 1152][Stage 7:=====>                                              (116 + 112) / 1152][Stage 7:======>                                             (145 + 112) / 1152][Stage 7:=======>                                            (158 + 112) / 1152][Stage 7:========>                                           (182 + 112) / 1152][Stage 7:=========>                                          (212 + 112) / 1152][Stage 7:==========>                                         (233 + 112) / 1152][Stage 7:===========>                                        (263 + 112) / 1152][Stage 7:============>                                       (286 + 112) / 1152][Stage 7:==============>                                     (314 + 112) / 1152][Stage 7:===============>                                    (340 + 112) / 1152][Stage 7:================>                                   (367 + 112) / 1152][Stage 7:=================>                                  (395 + 112) / 1152][Stage 7:===================>                                (423 + 112) / 1152][Stage 7:===================>                                (442 + 112) / 1152][Stage 7:====================>                               (462 + 112) / 1152][Stage 7:=====================>                              (487 + 112) / 1152][Stage 7:=======================>                            (520 + 112) / 1152][Stage 7:========================>                           (552 + 112) / 1152][Stage 7:==========================>                         (580 + 112) / 1152][Stage 7:===========================>                        (604 + 112) / 1152][Stage 7:============================>                       (621 + 113) / 1152][Stage 7:============================>                       (642 + 112) / 1152][Stage 7:=============================>                      (657 + 112) / 1152][Stage 7:==============================>                     (685 + 113) / 1152][Stage 7:================================>                   (717 + 112) / 1152][Stage 7:=================================>                  (743 + 112) / 1152][Stage 7:==================================>                 (769 + 112) / 1152][Stage 7:====================================>               (802 + 112) / 1152][Stage 7:=====================================>              (832 + 112) / 1152][Stage 7:=======================================>            (873 + 112) / 1152][Stage 7:=========================================>          (909 + 112) / 1152][Stage 7:===========================================>        (956 + 112) / 1152][Stage 7:=============================================>      (999 + 112) / 1152][Stage 7:=============================================>     (1031 + 112) / 1152][Stage 7:==============================================>    (1049 + 103) / 1152][Stage 7:================================================>   (1081 + 71) / 1152][Stage 7:=================================================>  (1096 + 56) / 1152][Stage 7:==================================================> (1112 + 40) / 1152][Stage 7:==================================================> (1123 + 29) / 1152][Stage 7:===================================================>(1134 + 18) / 1152][Stage 7:===================================================>(1139 + 13) / 1152][Stage 7:===================================================>(1141 + 11) / 1152][Stage 7:====================================================>(1143 + 9) / 1152][Stage 7:====================================================>(1146 + 6) / 1152][Stage 7:====================================================>(1147 + 5) / 1152][Stage 7:====================================================>(1148 + 4) / 1152][Stage 7:====================================================>(1149 + 3) / 1152][Stage 7:====================================================>(1151 + 1) / 1152]                                                                                [Stage 8:=>                                                   (36 + 112) / 1153][Stage 8:===>                                                 (66 + 112) / 1153][Stage 8:====>                                                (89 + 112) / 1153][Stage 8:=====>                                              (117 + 112) / 1153][Stage 8:======>                                             (140 + 112) / 1153][Stage 8:=======>                                            (160 + 112) / 1153][Stage 8:========>                                           (180 + 112) / 1153][Stage 8:=========>                                          (206 + 112) / 1153][Stage 8:==========>                                         (234 + 112) / 1153][Stage 8:===========>                                        (252 + 112) / 1153][Stage 8:============>                                       (284 + 112) / 1153][Stage 8:==============>                                     (315 + 112) / 1153][Stage 8:===============>                                    (337 + 112) / 1153][Stage 8:================>                                   (370 + 112) / 1153][Stage 8:==================>                                 (404 + 112) / 1153][Stage 8:===================>                                (422 + 112) / 1153][Stage 8:===================>                                (441 + 112) / 1153][Stage 8:====================>                               (457 + 112) / 1153][Stage 8:=====================>                              (482 + 112) / 1153][Stage 8:======================>                             (506 + 112) / 1153][Stage 8:========================>                           (533 + 112) / 1153][Stage 8:=========================>                          (568 + 112) / 1153][Stage 8:==========================>                         (591 + 112) / 1153][Stage 8:===========================>                        (614 + 112) / 1153][Stage 8:============================>                       (633 + 112) / 1153][Stage 8:=============================>                      (650 + 112) / 1153][Stage 8:==============================>                     (672 + 112) / 1153][Stage 8:===============================>                    (709 + 112) / 1153][Stage 8:================================>                   (730 + 112) / 1153][Stage 8:==================================>                 (763 + 112) / 1153][Stage 8:===================================>                (790 + 112) / 1153][Stage 8:=====================================>              (826 + 113) / 1153][Stage 8:======================================>             (856 + 113) / 1153][Stage 8:========================================>           (895 + 112) / 1153][Stage 8:==========================================>         (934 + 112) / 1153][Stage 8:===========================================>        (969 + 112) / 1153][Stage 8:============================================>      (1012 + 112) / 1153][Stage 8:=============================================>     (1036 + 112) / 1153][Stage 8:===============================================>    (1063 + 90) / 1153][Stage 8:=================================================>  (1095 + 58) / 1153][Stage 8:==================================================> (1110 + 43) / 1153][Stage 8:==================================================> (1114 + 39) / 1153][Stage 8:==================================================> (1124 + 29) / 1153][Stage 8:===================================================>(1132 + 21) / 1153][Stage 8:===================================================>(1137 + 16) / 1153][Stage 8:===================================================>(1143 + 10) / 1153][Stage 8:====================================================>(1145 + 8) / 1153][Stage 8:====================================================>(1147 + 6) / 1153][Stage 8:====================================================>(1148 + 5) / 1153][Stage 8:====================================================>(1149 + 4) / 1153][Stage 8:====================================================>(1150 + 3) / 1153][Stage 8:====================================================>(1151 + 2) / 1153][Stage 8:====================================================>(1152 + 1) / 1153]                                                                                Time elapsed: 24.525618624 seconds
>> Running query: SELECT imageBytes from data where partitionZIndex >= 1 and partitionZIndex <=8 and imageLevel = 0 and imageId = '1.svs'
[Stage 9:>                                                    (12 + 112) / 1152][Stage 9:=>                                                   (33 + 112) / 1152][Stage 9:==>                                                  (57 + 112) / 1152][Stage 9:===>                                                 (75 + 112) / 1152][Stage 9:====>                                                (99 + 112) / 1152][Stage 9:=====>                                              (129 + 112) / 1152][Stage 9:======>                                             (142 + 112) / 1152][Stage 9:=======>                                            (167 + 112) / 1152][Stage 9:========>                                           (194 + 112) / 1152][Stage 9:=========>                                          (219 + 112) / 1152][Stage 9:===========>                                        (244 + 112) / 1152][Stage 9:============>                                       (268 + 112) / 1152][Stage 9:=============>                                      (297 + 112) / 1152][Stage 9:==============>                                     (327 + 112) / 1152][Stage 9:===============>                                    (351 + 112) / 1152][Stage 9:=================>                                  (377 + 112) / 1152][Stage 9:==================>                                 (401 + 112) / 1152][Stage 9:===================>                                (424 + 112) / 1152][Stage 9:===================>                                (441 + 112) / 1152][Stage 9:====================>                               (461 + 112) / 1152][Stage 9:=====================>                              (483 + 112) / 1152][Stage 9:=======================>                            (516 + 112) / 1152][Stage 9:========================>                           (544 + 112) / 1152][Stage 9:=========================>                          (573 + 112) / 1152][Stage 9:==========================>                         (592 + 112) / 1152][Stage 9:===========================>                        (610 + 112) / 1152][Stage 9:============================>                       (632 + 112) / 1152][Stage 9:=============================>                      (653 + 112) / 1152][Stage 9:==============================>                     (680 + 112) / 1152][Stage 9:===============================>                    (708 + 112) / 1152][Stage 9:=================================>                  (737 + 112) / 1152][Stage 9:==================================>                 (763 + 112) / 1152][Stage 9:===================================>                (794 + 112) / 1152][Stage 9:=====================================>              (825 + 112) / 1152][Stage 9:=======================================>            (864 + 112) / 1152][Stage 9:========================================>           (906 + 112) / 1152][Stage 9:==========================================>         (944 + 112) / 1152][Stage 9:============================================>       (986 + 112) / 1152][Stage 9:=============================================>     (1017 + 112) / 1152][Stage 9:==============================================>    (1044 + 108) / 1152][Stage 9:===============================================>    (1063 + 89) / 1152][Stage 9:=================================================>  (1092 + 60) / 1152][Stage 9:==================================================> (1112 + 40) / 1152][Stage 9:==================================================> (1122 + 30) / 1152][Stage 9:==================================================> (1128 + 24) / 1152][Stage 9:===================================================>(1137 + 15) / 1152][Stage 9:===================================================>(1141 + 11) / 1152][Stage 9:====================================================>(1144 + 8) / 1152][Stage 9:====================================================>(1146 + 6) / 1152][Stage 9:====================================================>(1147 + 5) / 1152][Stage 9:====================================================>(1149 + 3) / 1152][Stage 9:====================================================>(1150 + 2) / 1152][Stage 9:====================================================>(1151 + 1) / 1152]                                                                                [Stage 10:=>                                                  (41 + 112) / 1153][Stage 10:==>                                                 (55 + 112) / 1153][Stage 10:===>                                                (79 + 112) / 1153][Stage 10:====>                                              (100 + 112) / 1153][Stage 10:=====>                                             (119 + 112) / 1153][Stage 10:======>                                            (143 + 112) / 1153][Stage 10:=======>                                           (165 + 112) / 1153][Stage 10:========>                                          (188 + 112) / 1153][Stage 10:=========>                                         (208 + 112) / 1153][Stage 10:==========>                                        (231 + 113) / 1153][Stage 10:===========>                                       (261 + 113) / 1153][Stage 10:============>                                      (288 + 113) / 1153][Stage 10:=============>                                     (316 + 112) / 1153][Stage 10:===============>                                   (345 + 112) / 1153][Stage 10:================>                                  (374 + 112) / 1153][Stage 10:=================>                                 (398 + 112) / 1153][Stage 10:==================>                                (415 + 112) / 1153][Stage 10:===================>                               (440 + 112) / 1153][Stage 10:====================>                              (460 + 112) / 1153][Stage 10:====================>                              (472 + 112) / 1153][Stage 10:======================>                            (499 + 112) / 1153][Stage 10:=======================>                           (525 + 112) / 1153][Stage 10:========================>                          (554 + 112) / 1153][Stage 10:=========================>                         (577 + 112) / 1153][Stage 10:==========================>                        (595 + 112) / 1153][Stage 10:===========================>                       (620 + 112) / 1153][Stage 10:============================>                      (638 + 112) / 1153][Stage 10:============================>                      (654 + 112) / 1153][Stage 10:==============================>                    (687 + 113) / 1153][Stage 10:===============================>                   (709 + 113) / 1153][Stage 10:================================>                  (734 + 112) / 1153][Stage 10:=================================>                 (760 + 112) / 1153][Stage 10:==================================>                (791 + 112) / 1153][Stage 10:====================================>              (822 + 112) / 1153][Stage 10:=====================================>             (857 + 112) / 1153][Stage 10:=======================================>           (893 + 112) / 1153][Stage 10:=========================================>         (930 + 112) / 1153][Stage 10:==========================================>        (968 + 112) / 1153][Stage 10:===========================================>      (1003 + 112) / 1153][Stage 10:=============================================>    (1038 + 112) / 1153][Stage 10:==============================================>    (1059 + 94) / 1153][Stage 10:================================================>  (1089 + 64) / 1153][Stage 10:================================================>  (1103 + 50) / 1153][Stage 10:=================================================> (1116 + 37) / 1153][Stage 10:=================================================> (1123 + 30) / 1153][Stage 10:==================================================>(1132 + 21) / 1153][Stage 10:==================================================>(1137 + 16) / 1153][Stage 10:==================================================>(1141 + 12) / 1153][Stage 10:===================================================>(1145 + 8) / 1153][Stage 10:===================================================>(1146 + 7) / 1153][Stage 10:===================================================>(1147 + 6) / 1153][Stage 10:===================================================>(1148 + 5) / 1153][Stage 10:===================================================>(1149 + 4) / 1153][Stage 10:===================================================>(1151 + 2) / 1153][Stage 10:===================================================>(1152 + 1) / 1153]                                                                                Time elapsed: 25.702431184 seconds

scala> 

scala> 

scala> :quit
17/04/24 12:01:03 WARN netty.Dispatcher: Message RemoteProcessDisconnected(128.110.152.15:46400) dropped. RpcEnv already stopped.
17/04/24 12:01:03 WARN netty.Dispatcher: Message RemoteProcessDisconnected(128.110.152.15:46400) dropped. RpcEnv already stopped.
17/04/24 12:01:06 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
130.8 G  /nidan/parquet/Slides-uncompressed-256-ZINDEX.prqt
